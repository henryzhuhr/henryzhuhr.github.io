import{_ as s,c as i,o as a,a4 as e}from"./chunks/framework.CUJjVNbl.js";const g=JSON.parse('{"title":"Supervisor","description":"","frontmatter":{},"headers":[],"relativePath":"development/supervisor/supervisor.md","filePath":"development/supervisor/supervisor.md","lastUpdated":1724588569000}'),t={name:"development/supervisor/supervisor.md"},r=e(`<h1 id="supervisor" tabindex="-1">Supervisor <a class="header-anchor" href="#supervisor" aria-label="Permalink to &quot;Supervisor&quot;">​</a></h1><h2 id="supervisor-1" tabindex="-1">Supervisor <a class="header-anchor" href="#supervisor-1" aria-label="Permalink to &quot;Supervisor&quot;">​</a></h2><blockquote><p>Supervisor is a client/server system that allows its users to control a number of processes on UNIX-like operating systems.</p></blockquote><p><a href="https://github.com/Supervisor/supervisor" target="_blank" rel="noreferrer">Supervisor</a> 是一个客户端/服务器系统，允许用户在类 UNIX 操作系统上控制多个进程。</p><ul><li>官方文档：<a href="http://supervisord.org/" target="_blank" rel="noreferrer">http://supervisord.org</a></li></ul><h2 id="an-zhuang" tabindex="-1">安装 <a class="header-anchor" href="#an-zhuang" aria-label="Permalink to &quot;安装&quot;">​</a></h2><p>有包括 <code>pip</code>(<a href="http://supervisord.org/installing.html#installing-to-a-system-with-internet-access" target="_blank" rel="noreferrer">online</a> &amp; <a href="http://supervisord.org/installing.html#installing-to-a-system-without-internet-access" target="_blank" rel="noreferrer">offline</a>)、 <a href="http://supervisord.org/installing.html#installing-a-distribution-package" target="_blank" rel="noreferrer">包管理器</a>(<code>apt</code>)等安装方式，以 <code>apt</code> 为例：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> supervisor</span></span></code></pre></div><p>设置开机自启动</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> supervisord.service</span></span></code></pre></div><h2 id="ji-ben-shi-yong" tabindex="-1">基本使用 <a class="header-anchor" href="#ji-ben-shi-yong" aria-label="Permalink to &quot;基本使用&quot;">​</a></h2><h3 id="pei-zhi-wen-jian" tabindex="-1">配置文件 <a class="header-anchor" href="#pei-zhi-wen-jian" aria-label="Permalink to &quot;配置文件&quot;">​</a></h3><p>安装完成后，执行命令<a href="http://supervisord.org/installing.html#creating-a-configuration-file" target="_blank" rel="noreferrer">生成默认/示例配置文件</a>在当前目录下</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># current directory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">echo_supervisord_conf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> supervisord.conf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># (Optional) root access required</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">echo_supervisord_conf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/supervisord.conf</span></span></code></pre></div><h3 id="tian-jia-cheng-xu" tabindex="-1">添加程序 <a class="header-anchor" href="#tian-jia-cheng-xu" aria-label="Permalink to &quot;添加程序&quot;">​</a></h3><p>编辑 <code>supervisord.conf</code> 文件（上一步生产的），添加程序配置 <a href="http://supervisord.org/configuration.html#programx-section" target="_blank" rel="noreferrer"><code>[program:x]</code></a></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span># 上面为原始的配置，添加如下内容</span></span>
<span class="line"><span>[program:foo]    # foo 为程序名称</span></span>
<span class="line"><span>command=/bin/cat # 程序命令</span></span></code></pre></div><h3 id="supervisord" tabindex="-1">supervisord <a class="header-anchor" href="#supervisord" aria-label="Permalink to &quot;supervisord&quot;">​</a></h3><p>启动 <code>supervisord</code> 服务（<code>supervisord</code> 命令行参数参考 <a href="http://supervisord.org/running.html#supervisord-command-line-options" target="_blank" rel="noreferrer">supervisord Command-Line Options</a> ）</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">supervisord</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> supervisord.conf</span></span></code></pre></div><p>这时候，<code>supervisord</code> 会启动 <code>cat</code> 进程并管理它。随后可以通过 <code>supervisorctl</code> 命令管理进程</p><h3 id="supervisorctl" tabindex="-1">supervisorctl <a class="header-anchor" href="#supervisorctl" aria-label="Permalink to &quot;supervisorctl&quot;">​</a></h3><p><code>supervisorctl</code> 是 Supervisor 的命令行客户端，用于与 Supervisor 服务器进行交互。</p><p><code>supervisorctl</code> 有两种访问方式：</p><ul><li>通过 <code>supervisorctl</code> 命令行</li><li>通过 <code>XML-RPC</code> 接口</li></ul><p>通过 <code>supervisorctl</code> 命令行管理的方式可以进入交互模式，也可以直接执行命令</p><p><strong>交互模式</strong>需要执行 <code>supervisorctl</code> 进入交互模式，随后可以执行如下命令</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># supervisorctl 交互模式中</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">supervisor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">status</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # 查看所有进程状态</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">supervisor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   foo</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 启动 foo 进程</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">supervisor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">stop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    foo</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 停止 foo 进程</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">supervisor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> foo</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 重启 foo 进程</span></span></code></pre></div><p><strong>直接命令执行</strong>则可以直接执行命令，如下</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">supervisorctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # 查看所有进程状态</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">supervisorctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   foo</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 启动 foo 进程</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">supervisorctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    foo</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 停止 foo 进程</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">supervisorctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> foo</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 重启 foo 进程</span></span></code></pre></div><p><code>supervisorctl</code> 命令行参数参考 <a href="http://supervisord.org/running.html#supervisorctl-command-line-options" target="_blank" rel="noreferrer">supervisorctl Command-Line Options</a></p><h2 id="pei-zhi-wen-jian-1" tabindex="-1">配置文件 <a class="header-anchor" href="#pei-zhi-wen-jian-1" aria-label="Permalink to &quot;配置文件&quot;">​</a></h2>`,32),n=[r];function p(l,o,h,d,k,c){return a(),i("div",null,n)}const v=s(t,[["render",p]]);export{g as __pageData,v as default};
